# üó∫Ô∏è Mapa Interactivo de Ubicaciones - VerdeGo

## üìã Descripci√≥n

El mapa interactivo muestra todas las ubicaciones registradas en la base de datos (tabla `locations`). Utiliza **Leaflet.js**, una biblioteca de mapas de c√≥digo abierto, ligera y con excelente experiencia de usuario. El mapa est√° centrado en **Bogot√°, Colombia** y muestra dos tipos de ubicaciones.

## ‚ú® Caracter√≠sticas

- **Mapa interactivo** centrado en Bogot√°, Colombia
- **Marcadores personalizados** con emojis seg√∫n el tipo de ubicaci√≥n
- **Filtros din√°micos** para mostrar ubicaciones por categor√≠a
- **Popups informativos** con detalles de cada ubicaci√≥n
- **Bot√≥n "C√≥mo llegar"** que abre Google Maps con direcciones
- **Dise√±o responsivo** que funciona en m√≥viles y tablets
- **Contador de ubicaciones** en tiempo real
- **Animaciones suaves** y transiciones

## üé® Tipos de Ubicaciones

El mapa soporta los siguientes tipos de ubicaciones:

| Tipo | Emoji | Color | Descripci√≥n |
|------|-------|-------|-------------|
| `verdego` | üåø | Verde | Ubicaciones VerdeGo (puntos de reciclaje oficiales) |
| `aliada` | üè™ | Azul | Tiendas Aliadas (comercios asociados) |

## üöÄ Implementaci√≥n

### Archivos Modificados/Creados

1. **`frontend/index.html`**
   - Estructura del mapa y secciones
   - Referencias a Leaflet CSS y JS
   - Contenedor del mapa y filtros
   - 2 filtros: Ubicaciones VerdeGo y Tiendas Aliadas

2. **`frontend/public/js/map.js`**
   - L√≥gica del mapa interactivo
   - Carga de ubicaciones desde API
   - Sistema de filtros
   - Marcadores personalizados
   - Centrado en Bogot√° (4.7110, -74.0721)

3. **`frontend/public/css/style.css`**
   - Estilos del mapa y secciones
   - Marcadores personalizados
   - Popups informativos
   - Dise√±o responsivo

4. **`backend/database/seed-locations.js`**
   - Script para poblar ubicaciones de ejemplo
   - 12 ubicaciones en diferentes localidades de Bogot√°

5. **`backend/database/clear-locations.js`**
   - Script para limpiar ubicaciones existentes
   - Reinicia el contador de IDs

## üì¶ Dependencias

### Frontend
- **Leaflet.js v1.9.4** (CDN)
  - CSS: `https://unpkg.com/leaflet@1.9.4/dist/leaflet.css`
  - JS: `https://unpkg.com/leaflet@1.9.4/dist/leaflet.js`

### Backend
- No requiere dependencias adicionales
- Usa la API existente: `GET /api/ubicaciones`

## üîß Uso

### 1. Iniciar el Servidor

```powershell
cd backend
node server.js
```

### 2. Poblar Ubicaciones de Ejemplo (Opcional)

Si tu base de datos est√° vac√≠a, puedes agregar ubicaciones de ejemplo en Bogot√°:

```powershell
cd backend
node database/seed-locations.js
```

### 3. Limpiar Ubicaciones Existentes (Si es necesario)

```powershell
cd backend
node database/clear-locations.js
```

### 4. Abrir el Frontend

Visita: `http://localhost:3000`

El mapa se cargar√° autom√°ticamente en la p√°gina de inicio.

## ÔøΩ Caracter√≠sticas del Mapa

### Filtros
- **Todas**: Muestra todas las ubicaciones
- **Ubicaciones VerdeGo**: Solo puntos oficiales VerdeGo (üåø)
- **Tiendas Aliadas**: Solo comercios asociados (üè™)

### Interacciones
- **Click en marcador**: Muestra informaci√≥n detallada
- **Bot√≥n "C√≥mo llegar"**: Abre Google Maps
- **Zoom**: Scroll o botones +/-
- **Arrastrar**: Mover el mapa

### Informaci√≥n Mostrada
- Nombre de la ubicaci√≥n
- Direcci√≥n completa
- Tipo de ubicaci√≥n
- Bot√≥n de navegaci√≥n

## üìç Ubicaciones de Ejemplo en Bogot√°

El script de seed incluye 12 ubicaciones distribuidas en diferentes localidades:

### Ubicaciones VerdeGo (7)
1. Centro Chapinero
2. Usaqu√©n
3. Fontib√≥n
4. Engativ√°
5. Kennedy
6. Teusaquillo
7. San Crist√≥bal

### Tiendas Aliadas (5)
1. √âxito Suba
2. Carulla Zona Rosa
3. Jumbo Calle 80
4. Ol√≠mpica Bosa
5. PriceSmart Soacha

## üì± Dise√±o Responsivo

El mapa se adapta autom√°ticamente a diferentes tama√±os de pantalla:

- **Desktop**: Mapa de 600px de alto, filtros horizontales
- **Tablet**: Mapa de 500px, filtros ajustados
- **Mobile**: Mapa de 400px, filtros apilados

## üîÑ Integraci√≥n con el Backend

### Endpoint Utilizado
```javascript
GET http://localhost:3000/api/ubicaciones
```

### Respuesta Esperada
```json
{
  "mensaje": "Ubicaciones obtenidas",
  "total": 12,
  "locations": [
    {
      "id": 1,
      "name": "VerdeGo Centro Chapinero",
      "address": "Carrera 13 #53-45, Chapinero, Bogot√°",
      "latitude": 4.6533,
      "longitude": -74.0621,
      "type": "verdego",
      "created_at": "2025-01-15 10:30:00"
    }
  ]
}
```

## üé® Personalizaci√≥n

### Cambiar el Centro del Mapa

En `frontend/public/js/map.js`, l√≠nea 30:

```javascript
map = L.map('map', {
    center: [4.7110, -74.0721], // Coordenadas de Bogot√°
    zoom: 12, // Cambiar nivel de zoom
    // ...
});
```

### Agregar Nuevos Tipos de Ubicaciones

1. **En el backend** (`locationController.js`): Acepta el nuevo tipo
2. **En `map.js`**: Agregar icono y configuraci√≥n
3. **En `index.html`**: Agregar bot√≥n de filtro
4. **En `style.css`**: Agregar estilos del marcador

### Cambiar el Estilo del Mapa

En `frontend/public/js/map.js`, l√≠nea 36:

```javascript
// Cambiar a otro proveedor de tiles
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    // ...
}).addTo(map);

// Opciones alternativas:
// - CartoDB: https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png
// - Stamen: https://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}.png
```

## ÔøΩ Soluci√≥n de Problemas

### El mapa no se muestra
- Verifica que el servidor backend est√© corriendo
- Revisa la consola del navegador para errores
- Aseg√∫rate de que Leaflet CSS/JS se carguen correctamente

### No aparecen ubicaciones
- Verifica que haya datos en la tabla `locations`
- Ejecuta el script de seed: `node database/seed-locations.js`
- Revisa que las coordenadas sean v√°lidas (latitude, longitude)

### Marcadores no se ven bien
- Limpia el cach√© del navegador
- Verifica que los estilos CSS se hayan cargado

## üìà Mejoras Futuras

- [ ] B√∫squeda de ubicaciones por nombre
- [ ] Geolocalizaci√≥n del usuario
- [ ] Rutas entre ubicaciones
- [ ] Clusterizaci√≥n de marcadores
- [ ] Vista de lista + mapa
- [ ] Filtros avanzados (horario, servicios)
- [ ] Compartir ubicaciones
- [ ] Calificaciones y comentarios

## üìÑ Licencia

Este mapa es parte del proyecto VerdeGo y utiliza:
- **Leaflet.js**: BSD 2-Clause License
- **OpenStreetMap**: ODbL License

## ü§ù Contribuciones

Para agregar nuevas ubicaciones:

1. Usar el endpoint: `POST /api/ubicacion`
2. Proporcionar: `name`, `address`, `latitude`, `longitude`, `type`
3. Los tipos v√°lidos son: `verdego` o `aliada`
4. El mapa se actualizar√° autom√°ticamente

## üìû Soporte

Si encuentras problemas o tienes sugerencias, contacta al equipo de desarrollo de VerdeGo.

## üöÄ Implementaci√≥n

### Archivos Modificados/Creados

1. **`frontend/index.html`**
   - Estructura del mapa y secciones
   - Referencias a Leaflet CSS y JS
   - Contenedor del mapa y filtros

2. **`frontend/public/js/map.js`**
   - L√≥gica del mapa interactivo
   - Carga de ubicaciones desde API
   - Sistema de filtros
   - Marcadores personalizados

3. **`frontend/public/css/style.css`**
   - Estilos del mapa y secciones
   - Marcadores personalizados
   - Popups informativos
   - Dise√±o responsivo

4. **`backend/database/seed-locations.js`** (opcional)
   - Script para poblar ubicaciones de ejemplo
   - 10 ubicaciones en diferentes distritos de Lima

## üì¶ Dependencias

### Frontend
- **Leaflet.js v1.9.4** (CDN)
  - CSS: `https://unpkg.com/leaflet@1.9.4/dist/leaflet.css`
  - JS: `https://unpkg.com/leaflet@1.9.4/dist/leaflet.js`

### Backend
- No requiere dependencias adicionales
- Usa la API existente: `GET /api/ubicaciones`

## üîß Uso

### 1. Iniciar el Servidor

```powershell
cd backend
node server.js
```

### 2. Poblar Ubicaciones de Ejemplo (Opcional)

Si tu base de datos est√° vac√≠a, puedes agregar ubicaciones de ejemplo:

```powershell
cd backend
node database/seed-locations.js
```

### 3. Abrir el Frontend

Visita: `http://localhost:3000`

El mapa se cargar√° autom√°ticamente en la p√°gina de inicio.

## üéØ Caracter√≠sticas del Mapa

### Filtros
- **Todas**: Muestra todas las ubicaciones
- **Reciclaje**: Solo centros de reciclaje (‚ôªÔ∏è)
- **Centros Verdes**: Solo puntos verdes (üå±)
- **Contenedores**: Solo contenedores (üóëÔ∏è)

### Interacciones
- **Click en marcador**: Muestra informaci√≥n detallada
- **Bot√≥n "C√≥mo llegar"**: Abre Google Maps
- **Zoom**: Scroll o botones +/-
- **Arrastrar**: Mover el mapa

### Informaci√≥n Mostrada
- Nombre de la ubicaci√≥n
- Direcci√≥n completa
- Tipo de ubicaci√≥n
- Bot√≥n de navegaci√≥n

## üì± Dise√±o Responsivo

El mapa se adapta autom√°ticamente a diferentes tama√±os de pantalla:

- **Desktop**: Mapa de 600px de alto, filtros horizontales
- **Tablet**: Mapa de 500px, filtros ajustados
- **Mobile**: Mapa de 400px, filtros apilados

## üîÑ Integraci√≥n con el Backend

### Endpoint Utilizado
```javascript
GET http://localhost:3000/api/ubicaciones
```

### Respuesta Esperada
```json
{
  "mensaje": "Ubicaciones obtenidas",
  "total": 10,
  "locations": [
    {
      "id": 1,
      "name": "Centro de Reciclaje San Isidro",
      "address": "Av. Javier Prado Este 450, San Isidro",
      "latitude": -12.0931,
      "longitude": -77.0465,
      "type": "reciclaje",
      "created_at": "2025-01-15 10:30:00"
    }
  ]
}
```

## üé® Personalizaci√≥n

### Cambiar el Centro del Mapa

En `frontend/public/js/map.js`, l√≠nea 37:

```javascript
map = L.map('map', {
    center: [-12.0464, -77.0428], // Cambiar coordenadas
    zoom: 12, // Cambiar nivel de zoom
    // ...
});
```

### Agregar Nuevos Tipos de Ubicaciones

1. **En el backend** (`locationController.js`): Acepta el nuevo tipo
2. **En `map.js`**: Agregar icono y configuraci√≥n
3. **En `index.html`**: Agregar bot√≥n de filtro
4. **En `style.css`**: Agregar estilos del marcador

### Cambiar el Estilo del Mapa

En `frontend/public/js/map.js`, l√≠nea 43:

```javascript
// Cambiar a otro proveedor de tiles
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    // ...
}).addTo(map);

// Opciones alternativas:
// - CartoDB: https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png
// - Stamen: https://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}.png
```

## üêõ Soluci√≥n de Problemas

### El mapa no se muestra
- Verifica que el servidor backend est√© corriendo
- Revisa la consola del navegador para errores
- Aseg√∫rate de que Leaflet CSS/JS se carguen correctamente

### No aparecen ubicaciones
- Verifica que haya datos en la tabla `locations`
- Ejecuta el script de seed: `node database/seed-locations.js`
- Revisa que las coordenadas sean v√°lidas (latitude, longitude)

### Marcadores no se ven bien
- Limpia el cach√© del navegador
- Verifica que los estilos CSS se hayan cargado

## üìà Mejoras Futuras

- [ ] B√∫squeda de ubicaciones por nombre
- [ ] Geolocalizaci√≥n del usuario
- [ ] Rutas entre ubicaciones
- [ ] Clusterizaci√≥n de marcadores
- [ ] Vista de lista + mapa
- [ ] Filtros avanzados (horario, servicios)
- [ ] Compartir ubicaciones
- [ ] Calificaciones y comentarios

## üìÑ Licencia

Este mapa es parte del proyecto VerdeGo y utiliza:
- **Leaflet.js**: BSD 2-Clause License
- **OpenStreetMap**: ODbL License

## ü§ù Contribuciones

Para agregar nuevas ubicaciones:

1. Usar el endpoint: `POST /api/ubicacion`
2. Proporcionar: `name`, `address`, `latitude`, `longitude`, `type`
3. El mapa se actualizar√° autom√°ticamente

## üìû Soporte

Si encuentras problemas o tienes sugerencias, contacta al equipo de desarrollo de VerdeGo.
